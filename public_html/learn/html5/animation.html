<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>ArtAI: HTML5
 Animation</title>
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
	<nav>
	<a href="../index.html">Index of /learn/.</a>
	<a href="index.html">Index of /html5/.</a>
	<a href="introduction.html">Introduction.</a>
	<a href="basics.html">Basics.</a>
	<a href="multimedia.html">Multimedia.</a>
	<a href="graphics.html">Graphics.</a>
	<a href="animation.html">Animation.</a>
	</nav>


<h1>Animation</h1>
<p><h2>Principles</h2></p>
<p><ul><li>Clear the canvas.
</li>
<li>
Draw.
</li>
<li>
Alter the drawers.
</li>
<li>
Repeat.
</li>
</ul></p>
<p>Step 1 could be avoided if you redraw the whole canvas content during step 2.</p>
<p>Before html5 animations were done with setInterval/setTimeOut functions. Now best practice is to use requestAnimationFrame. Comparison of methods: 
<a href="http://jsbin.com/feqije/edit?html,output"> </a></p>
<p>The old way is hard to debug and can become jammed since it will call again regardless of what happened in the previous call. The timing is also not very exact.</p>
<p>BEST PRACTICE: AVOID using setInterval and setTimeout for animating in a canvas, 
except for trivial cases  (change a color every second).</p>
<p>With requestAnimationFrame(animationLoop) timing is very precise at 60 FPS (Frames Per Second) and the animation also runs more efficiently.</p>
<p><a href="http://jsbin.com/jixuju/4/edit">http://jsbin.com/jixuju/4/edit</a></p>
<p><h3>Suggested projects</h3></p>
<p><ul><li>Project 1 (easy): You created a monster, or a small drawing during Week 3: now please animate it! For example, make it move horizontally on the screen and bounce when it hits a vertical border.
</li>
<li>
Project 2 (easy): Change the color of your drawing every 0.5s. Professionals would do that using the timeStamp parameter passed to the function called by requestAnimationFrame, and do some computations, etc. But this is for advanced users. Others will simply use requestAnimationFrame for the smooth shape movements at 60 frames/s (using translate, rotate and increments, as shown in the course), and will use setInterval, for example for calling another function every 0.5s, or every second, that could change a color, a speed, etc.
</li>
<li>
Project 3 (easy): Run several animations at the same time (beware not to clear the canvas in all of them during each animation loop, one clear is enough). You can also have multiple calls to setInterval. Try and learn from experience. Then discuss your findings in the forum. 
</li>
<li>
Project 4 (easy): Implement motion blur for free! Instead of using clearRect(...) for clearing the canvas content, please comment this line and replace it by drawing a filled rectangle of the size of the canvas, that has some transparency. Use the following two lines, for example: <br>ctx.fillStyle = "rgba(0, 240, 240, 0.2)";<br>ctx.fillRect (0, 0, width, height); 
</li>
</ul></p>
<p><h2>User interaction</h2></p>
<p>In JavaScript, we treat events made by users as an input, and we manipulate the DOM structure as an output. The events are called DOM events, and we use the DOM JavaScript API to create event handlers.</p>
<p>3 ways to handle events:
<ul><li>Declare event handlers in the HTML code: not recommended, there should be a cleaner separation of the javascript code.
</li>
<li>
Add an event handler to an HTML element in JavaScript: fine but limited to a single listener.
</li>
<li>
Register a callback to the event listener with the addEventListener method: document.getElementById('someDiv').addEventListener('click', fun(event));
</li>
</ul></p>
<p>Example with the third way: 
<a href="http://jsbin.com/korele/edit?html,console,output">http://jsbin.com/korele/edit?html,console,output</a></p>
<p><h3>Keys</h3></p>
<p><a href="http://www.asquare.net/javascript/tests/KeyCode.html">http://www.asquare.net/javascript/tests/KeyCode.html</a></p>
<p><a href="http://css-tricks.com/snippets/javascript/javascript-keycodes/">http://css-tricks.com/snippets/javascript/javascript-keycodes/</a></p>
<p><a href="http://jsbin.com/voviva/2/edit">http://jsbin.com/voviva/2/edit</a></p>
<p>As above but with focus feature:
<a href="http://jsbin.com/cohide/2/edit">http://jsbin.com/cohide/2/edit</a></p>
<p>Move the monster: 
<a href="http://jsbin.com/qorupi/edit">http://jsbin.com/qorupi/edit</a></p>
<p>As above but with better focus feature:
<a href="http://jsbin.com/johaco/edit">http://jsbin.com/johaco/edit</a></p>
<p><h3>Mouse events</h3></p>
<p><ul><li>mouseleave
</li>
<li>
mouseout
</li>
<li>
mouseover
</li>
<li>
mousedown
</li>
<li>
mouseup
</li>
<li>
mouseclick
</li>
<li>
mousemove
</li>
</ul></p>
<p>How to get correct mouse coordinates:
<a href="http://jsbin.com/miduqu/3/edit">http://jsbin.com/miduqu/3/edit</a></p>
<p>Adding button presses:
<a href="http://jsbin.com/miduqu/2/edit">http://jsbin.com/miduqu/2/edit</a></p>
<p>Moving the monster:
<a href="http://jsbin.com/pedihokoyu/1/edit">http://jsbin.com/pedihokoyu/1/edit</a></p>
<p>Draw:
<a href="http://jsbin.com/bijusa/3/edit">http://jsbin.com/bijusa/3/edit</a></p>
<p>More drawing:
<a href="http://jsbin.com/lavexi/3/edit">http://jsbin.com/lavexi/3/edit</a></p>
<p><h3>Canvas</h3></p>
<p>Changing width or height properties erases content:
<a href="http://jsbin.com/tukave/2/edit">http://jsbin.com/tukave/2/edit</a></p>
<p>Changing % size with CSS does not change resolution:
<ul><li><a href="http://jsbin.com/luvuhe/4/edit">http://jsbin.com/luvuhe/4/edit</a>
</li>
<li>
<a href="http://jsbin.com/pajifo/2/edit">http://jsbin.com/pajifo/2/edit</a>
</li>
</ul></p>
<p>GOOD PRACTICE: never use CSS percentages on a canvas width or height!</p>
<p>This is the trick in order to have a really responsive canvas:
<ul><li>embed it in a <div> or in any parent container,
</li>
<li>
Use CSS with percentages on the width and the height CSS properties of the parent,
</li>
<li>
Use a resize listener on the  parent of the canvas,
</li>
<li>
Change the width and height properties of the canvas from the JavaScript resize listener function (content will be erased),
</li>
<li>
Redraw the content, scaled accordingly to the size of the parent.
</li>
</ul></p>
<p>Like so:
<ul><li><a href="http://jsbin.com/tubufo/2/edit">http://jsbin.com/tubufo/2/edit</a>
</li>
<li>
<a href="http://jsbin.com/xoqipo/3/edit">http://jsbin.com/xoqipo/3/edit</a>
</li>
</ul></p>
<p><h3>Suggested projects</h3></p>
<p><ul><li>Project 1 (easy): Make one of your drawings move in all directions (left, right up, down, then diagonals) using the arrow keys.
</li>
<li>
Project 2 (a bit harder): Make an animated chart. When the page is loaded, the chart "grows" until the chart bars reach  their "normal" value. Another variant is to use animated colors or shadows in your chart.
</li>
<li>
Project 3 (a bit harder): Make your monster follow the mouse + open its mouth and change color when we click on a mouse button. If you manage to make it scream, it's even better (use a hidden audio element and call play(), advanced users may give a look at the howler.js JavaScript library that loads sound samples in memory and plays them on demand). 
</li>
<li>
Project 4 (advanced): On the Web, look for JavaScript functions for detecting collisions (circle/circle or rectangle/rectangle), and try to make a small game where your monster must "eat" some balls that bounce on the screen. Every 5s new balls appear on the canvas. Make your monster go towards the mouse pointer. You can use var angle = Math.atan2(dy, dx); in order to compute the monster angle, dx and dy = difference between the monster and mouse positions.
</li>
<li>
Project 5 (easy to intermediate): Put into practice what you've learned about the responsive canvas and develop an example of your own. The difficulty may vary depending on the things that are drawn or animated.
</li>
</ul></p>
<p><h2>Advanced examples</h2></p>
<p>Collision detection:
<a href="http://jsbin.com/bemebi/11/edit">http://jsbin.com/bemebi/11/edit</a></p>

Sprite animation:
<a href="http://output.jsbin.com/qumiso/5">http://output.jsbin.com/qumiso/5</a>


</body>
</html>