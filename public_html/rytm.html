<!DOCTYPE HTML>
<html>
<head>
	<title>ARTai</title>
</head>

<body>
	<h1>Rytm!</h1>

Left arrow: <br>BPM: <input type="number" id="bpm1" value="60"> <input type="range" id="range1" value="100" style="background:#ff00ff;"> <input type="checkbox" id="c1">  
<br>
Down arrow: <br>BPM: <input type="number" id="bpm2" value="50"> <input type="range" id="range2" value="100" style="background:#ff00ff;"> <input type="checkbox" id="c2"> 
<br>
Right arrow: <br>BPM: <input type="number" id="bpm3" value="40"> <input type="range" id="range3" value="100" style="background:#ff00ff;"> <input type="checkbox" id="c3"> 
<br>
<button onclick="move()">Start a 60 seconds session!</button><br><br>
Score: <p id="score">0</p>
Max: <div id="max"></p>


<script>
document.onkeydown=function(evt){
	evt=evt||window.event;
	//alert('Pressed button '+evt.keyCode);
	if (evt.keyCode==37){ //left arrow
		var c1 = document.getElementById("c1");
		if (!c1.checked){
			s=parseInt(document.getElementById("score").innerHTML);
			s=s+parseInt(document.getElementById("range1").value);
			document.getElementById("score").innerHTML = s;
			c1.checked=true;
		}
	} else if (evt.keyCode==40){ //down arrow
		var c2 = document.getElementById("c2");
		if (!c2.checked){
			s=parseInt(document.getElementById("score").innerHTML);
			s=s+parseInt(document.getElementById("range2").value);
			document.getElementById("score").innerHTML = s;
			c2.checked=true;
		}
	} else if (evt.keyCode==39){ //right arrow
		var c3 = document.getElementById("c3");
		if (!c3.checked){
			s=parseInt(document.getElementById("score").innerHTML);
			s=s+parseInt(document.getElementById("range3").value);
			document.getElementById("score").innerHTML = s;
			c3.checked=true;
		}
	}
}
function move() {
	document.getElementById("c1").checked=false;
	document.getElementById("c2").checked=false;
	document.getElementById("c3").checked=false;
	document.getElementById("score").innerHTML=0;
	var hz1 = document.getElementById("bpm1").value/60;
	var hz2 = document.getElementById("bpm2").value/60;
	var hz3 = document.getElementById("bpm3").value/60;
	document.getElementById("max").innerHTML = hz1*60*100+hz2*60*100+hz3*60*100+300;
	var d = new Date();
	var t = d.getTime();
	var now=d.getTime();
	var dt = now-t;
	var id = setInterval(frame, 100);
	function frame() {
		if (dt >= 60*1000) {
			clearInterval(id);
		} else {
			var d = new Date();
			dt=d.getTime()-t;
			val1=Math.round(150*Math.abs(Math.cos(hz1*dt/1000*3.14)))-50;
			val2=Math.round(150*Math.abs(Math.cos(hz2*dt/1000*3.14)))-50;
			val3=Math.round(150*Math.abs(Math.cos(hz3*dt/1000*3.14)))-50;
			document.getElementById("range1").value=val1;
			document.getElementById("range2").value=val2;
			document.getElementById("range3").value=val3;
			var c1 = document.getElementById("c1");
			if (val1<0 && c1.checked){
				c1.checked=false;
			}
			var c2 = document.getElementById("c2");
			if (val2<0 && c2.checked){
				c2.checked=false;
			}
			var c3 = document.getElementById("c3");
			if (val3<0 && c3.checked){
				c3.checked=false;
			}
		}
	}
}
</script>
</body>
</html>
